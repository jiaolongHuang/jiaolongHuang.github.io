<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> 用javascript对象模拟LRUcache缓存池（百度2014校招前端笔试题） · 小路口</title><meta name="description" content="用javascript对象模拟LRUcache缓存池（百度2014校招前端笔试题） - jiaolongHuang"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="short icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://jiaolongHuang.github.io/atom.xml" title="小路口"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">ARCHIVE</a></li><li class="nav-list-item"><a href="http://weibo.com/minel" target="_blank" class="nav-list-link">WEIBO</a></li><li class="nav-list-item"><a href="https://github.com/jiaolonghuang" target="_blank" class="nav-list-link">GITHUB</a></li></ul></header><section class="container"><div class="post"><article class="post-block"><h1 class="post-title">用javascript对象模拟LRUcache缓存池（百度2014校招前端笔试题）</h1><div class="post-info">Oct 3, 2013</div><div class="post-content"><p>LUR指的是内存管理中，淘汰页面时选择最近最久未使用的那个。  </p>
<figure class="highlight processing"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment">/* 利用数组模拟缓存池</span></div><div class="line"> * 每个数组元素是一个对象，&#123;k:v&#125;,k-&gt;key,v-&gt;value</div><div class="line"> * key可看为是块号，value可看为是块中的内容</div><div class="line"> * 块号可相同，但块中的内容则不一定相同</div><div class="line"> */</div><div class="line">		function LRUcache(<span class="built_in">size</span>)</div><div class="line">		&#123;</div><div class="line">			<span class="keyword">this</span>.<span class="built_in">size</span> = typeof <span class="built_in">size</span> === <span class="string">"number"</span> ? <span class="built_in">size</span> : <span class="number">0</span>;</div><div class="line">			<span class="keyword">if</span>(<span class="keyword">this</span>.<span class="built_in">size</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">this</span>.elements = <span class="keyword">new</span> <span class="keyword">Array</span>();</div><div class="line">			&#125;</div><div class="line">		&#125;</div><div class="line"></div><div class="line"><span class="comment">/*flag标记在缓存池中是否已存在与key值相同的块或页</span></div><div class="line"> *flag = 0,不存在，flag = 1 存在</div><div class="line"> */</div><div class="line">		LRUcache.prototype.<span class="built_in">add</span> = function(<span class="built_in">key</span>,value)&#123;</div><div class="line"></div><div class="line">			var i,</div><div class="line">				flag = <span class="number">0</span>,</div><div class="line">				len = <span class="keyword">this</span>.elements.length,</div><div class="line">				<span class="built_in">key</span> = typeof <span class="built_in">key</span> === <span class="string">"number"</span> ? <span class="built_in">key</span> : <span class="number">-1</span>;</div><div class="line"></div><div class="line">			<span class="keyword">if</span>(<span class="built_in">key</span> != <span class="number">-1</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">for</span>(i = <span class="number">0</span>;i &lt; len; i++)</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.elements[i].k == <span class="built_in">key</span>)</div><div class="line">					&#123;</div><div class="line">						<span class="comment">// 找到已存在的key值块或页，就从缓存池中去除</span></div><div class="line">						<span class="comment">// 简单的做法就是用后面的块覆盖它</span></div><div class="line">						<span class="comment">// 最后再将较新的块放在缓存池的顶部，即数组中的最后一个位置</span></div><div class="line">						<span class="keyword">for</span>(j = i ;j &lt; len - <span class="number">1</span>; j++)</div><div class="line">							<span class="keyword">this</span>.elements[j] = <span class="keyword">this</span>.elements[j + <span class="number">1</span>];</div><div class="line">						<span class="keyword">this</span>.elements[j] = &#123;k:<span class="built_in">key</span>,v:value&#125;;</div><div class="line">						flag = <span class="number">1</span>;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">if</span>(!flag)</div><div class="line">				&#123;</div><div class="line">					<span class="comment">// 如果此时缓存池已满且即将放入的块是新的，则队头出一项</span></div><div class="line">					<span class="comment">// 将新的块压入缓存池中</span></div><div class="line">					<span class="keyword">if</span>(len == <span class="keyword">this</span>.<span class="built_in">size</span>)</div><div class="line">					&#123;</div><div class="line">						<span class="keyword">this</span>.elements.shift();		</div><div class="line">					&#125;</div><div class="line">					<span class="keyword">this</span>.elements.push(&#123;k:<span class="built_in">key</span>,v:value&#125;);	</div><div class="line">				&#125;</div><div class="line">				<span class="keyword">return</span> <span class="keyword">true</span>;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> <span class="keyword">false</span>;</div><div class="line">		&#125;;</div><div class="line"></div><div class="line">		LRUcache.prototype.<span class="built_in">get</span> = function(<span class="built_in">key</span>)&#123;</div><div class="line"></div><div class="line">			var i,</div><div class="line">				len = <span class="keyword">this</span>.elements.length,</div><div class="line">				<span class="built_in">key</span> = typeof <span class="built_in">key</span> == <span class="string">"number"</span> ? <span class="built_in">key</span> : <span class="number">-1</span>;</div><div class="line"></div><div class="line">			<span class="keyword">if</span>(<span class="built_in">key</span> != <span class="number">-1</span>)</div><div class="line">			&#123;</div><div class="line">				<span class="keyword">for</span>(i = <span class="number">0</span>; i &lt; len; i++)</div><div class="line">				&#123;</div><div class="line">					<span class="keyword">if</span>(<span class="keyword">this</span>.elements[i].k == <span class="built_in">key</span>)</div><div class="line">					&#123;</div><div class="line">						var tmp = <span class="keyword">this</span>.elements[i].v;</div><div class="line">						</div><div class="line">						<span class="keyword">for</span>(j = i ;j &lt; len - <span class="number">1</span>; j++)</div><div class="line">						<span class="keyword">this</span>.elements[j] = <span class="keyword">this</span>.elements[j + <span class="number">1</span>];</div><div class="line">					</div><div class="line">						<span class="comment">// 找到key块，并移动过元素后，将数组中多余的队尾元素弹出</span></div><div class="line">						<span class="keyword">this</span>.elements.pop();</div><div class="line">						<span class="keyword">return</span> tmp;</div><div class="line">					&#125;</div><div class="line">				&#125;</div><div class="line">			&#125;</div><div class="line">			<span class="keyword">return</span> <span class="number">-1</span>;</div><div class="line">		&#125;;</div><div class="line">测试用例：</div><div class="line"></div><div class="line">var l = <span class="keyword">new</span> LRUcache(<span class="number">3</span>);</div><div class="line"></div><div class="line">		l.<span class="built_in">add</span>(<span class="number">3</span>,<span class="number">1</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">5</span>,<span class="number">2</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">1</span>,<span class="number">3</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">2</span>,<span class="number">4</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">3</span>,<span class="number">5</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">1</span>,<span class="number">6</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="number">5</span>,<span class="number">7</span>);</div><div class="line">		l.<span class="built_in">add</span>(<span class="string">"5"</span>,<span class="number">8</span>);</div><div class="line"></div><div class="line">		<span class="keyword">for</span>(var i = <span class="number">0</span>, len = l.elements.length; i &lt; len; i++)</div><div class="line">			console.<span class="built_in">log</span>(l.elements[i]);</div><div class="line"></div><div class="line">		console.<span class="built_in">log</span>(l.<span class="built_in">get</span>(<span class="number">1</span>));</div><div class="line">		console.<span class="built_in">log</span>(l.<span class="built_in">get</span>(<span class="string">"a"</span>));</div><div class="line"></div><div class="line">		console.<span class="built_in">log</span>(l);</div></pre></td></tr></table></figure>
<p>结果：<br><img src="http://p3.qhimg.com/t01f2762c3d922eef35.png"></p>
<p>值得注意的点：</p>
<p>1. var test = [{“a”:1,”b”:”jack”}];，表示的是test为一个数组，数组中有一个元素，这个元素的类型为一个对象是{“a”:1,”b”:”jack”}.</p>
<p>2. var pp = {“element” : [1,2,3,4]},表示的是pp是一个对象，对象中有一个属性element,这个属性是一个数组，为[1,2,3,4],可以通过pp.element[0]…来访问数组其中的元素。</p>
<p>3. 读取对象属性时，如果对象内部的键值为字符串类型，比如”name”,那么可以test1.name,或者test1[“name”];</p>
<p>如果内部的键值为number类型，则只能是test1[1];</p>
<p>4. typeof 对象.属性，（属性就是那个键值），键值对应的值的类型是什么，typeof出来的就是什么。</p>
<p>版权声明：本文为博主原创文章，未经博主允许不得转载。</p>
</div></article></div></section><footer><div class="paginator"><a href="/2013/10/03/5/" class="prev">PREV</a><a href="/2013/09/14/7/" class="next">NEXT</a></div><div data-thread-key="2013/10/03/6/" data-title="用javascript对象模拟LRUcache缓存池（百度2014校招前端笔试题）" data-url="http://jiaolongHuang.github.io/2013/10/03/6/" data-author-key="1" class="ds-thread"></div><script>var duoshuoQuery = {short_name:"minel"};
(function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';ds.async = true;
    ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] 
     || document.getElementsByTagName('body')[0]).appendChild(ds);
})();

</script><div class="copyright"><p>友情链接：<a href="https://imququ.com" class="links-item">QuQu</a><a href="http://anjia.github.io" class="links-item">跑跑佳</a><a href="http://www.imwineki.cn/" class="links-item">Wineki</a><a href="http://westpsk.com/" class="links-item">ivan</a></p><p>© 2015 - 2017 <a href="http://jiaolongHuang.github.io">jiaolongHuang</a>. Love this theme <a href="https://github.com/pinggod/hexo-theme-apollo">apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.6.1/MathJax.js?config=TeX-MML-AM_CHTML"></script><script>(function(b,o,i,l,e,r){b.GoogleAnalyticsObject=l;b[l]||(b[l]=function(){(b[l].q=b[l].q||[]).push(arguments)});b[l].l=+new Date;e=o.createElement(i);r=o.getElementsByTagName(i)[0];e.src='//www.google-analytics.com/analytics.js';r.parentNode.insertBefore(e,r)}(window,document,'script','ga'));ga('create',"UA-65933410-1",'auto');ga('send','pageview');</script></body></html>